<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>ç®­é ­æŒ‘æˆ°éŠæˆ²</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      background-color: #fefefe;
    }
    input {
      width: 60px;
      font-size: 16px;
      margin-right: 10px;
    }
    button {
      padding: 5px 12px;
      font-size: 16px;
    }
    #question {
      font-size: 32px;
      margin: 20px 0;
    }
    #result {
      margin-top: 20px;
      font-size: 14px;
    }
    #history {
      margin-top: 10px;
      font-size: 14px;
    }
    .back-home {
      margin-top: 20px;
      display: inline-block;
      padding: 8px 16px;
      background-color: #d8b4f8;
      color: #000;
      border-radius: 8px;
      text-decoration: none;
      font-size: 14px;
    }
    .back-home:hover {
      background-color: #c084fc;
    }

    /* æ‰‹æ©Ÿç‰ˆæ§åˆ¶æŒ‰éˆ•å€ */
    .mobile-controls {
      display: block; /* âœ… æ”¹ç‚ºæ°¸é é¡¯ç¤º */
      margin-top: 20px;
    }

    .mobile-controls button {
      width: 50px;
      height: 50px;
      font-size: 24px;
      margin: 5px;
      border-radius: 8px;
    }

    /* ä¸Šä¸‹å·¦å³æ’åˆ— */
    .mobile-direction {
      display: flex;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
    }

    /* ç­”é¡Œéµ */
    .submit-btn {
      margin-top: 10px;
      width: 300px;
      font-size: 50px;
      padding: 50px;
      background-color: #fdd;
      border-radius: 6px;
      border: none;
      display: flex;
      justify-content: center;
      align-items: center;
      text-align: center;
    }

    /* âœ… åƒ…åœ¨æ‰‹æ©Ÿå¯¬åº¦é¡¯ç¤º 
    @media (max-width: 768px) {
    .mobile-controls {
      display: block;
    }
    }*/


  </style>
</head>
<body>
  <h2>ğŸ¯ ç®­é ­æŒ‘æˆ°éŠæˆ²</h2>
  <div>
    æœ€å°ç®­é ­æ•¸ï¼š<input type="number" id="minLen" value="3" min="3">
    æœ€å¤§ç®­é ­æ•¸ï¼š<input type="number" id="maxLen" value="7" min="3">
    é¡Œæ•¸ï¼š<input type="number" id="count" value="10" min="1">
    <button onclick="startGame()">é–‹å§‹</button>
    <button onclick="giveUp()">æ”¾æ£„</button>
    <button onclick="clearHistory()">æ¸…é™¤ç´€éŒ„</button>
    <a href="index.html" class="back-home">ğŸ  å›é¦–é </a>
    
  </div>

  <div id="question"></div>
  <input id="answerInput" type="text" placeholder="è¼¸å…¥â†‘â†“â†â†’" autocomplete="off" style="width: 300px; font-size: 24px;">
  <div id="result"></div>
  <div id="history"></div>





<div class="mobile-controls">
  <div class="mobile-direction">
    <div style="text-align: center; width: 100%;">
      <button onclick="simulateKey('ArrowUp')">â†‘</button>
    </div>
    <div style="display: flex; justify-content: center; gap: 10px;">
      <button onclick="simulateKey('ArrowLeft')">â†</button>
      <button onclick="simulateKey('ArrowDown')">â†“</button>
      <button onclick="simulateKey('ArrowRight')">â†’</button>
    </div>
  </div>
  <button class="submit-btn" onclick="checkAnswer()">âœ… é€å‡º</button>
</div>




  <script>
    const arrowMap = {
      ArrowUp: 'â†‘',
      ArrowDown: 'â†“',
      ArrowLeft: 'â†',
      ArrowRight: 'â†’',
      w: 'â†‘',
      s: 'â†“',
      a: 'â†',
      d: 'â†’'
    };

    let questions = [];
    let currentIndex = 0;
    let wrongCount = 0;
    let startTime = null;
    let totalQuestions = 0;

    const input = document.getElementById('answerInput');
    const questionDiv = document.getElementById('question');
    const resultDiv = document.getElementById('result');
    const historyDiv = document.getElementById('history');

    document.addEventListener('keydown', e => {
  if (!questions.length) return;

  // âœ… æŒ‰æ–¹å‘éµæˆ– WASD æ™‚è™•ç†è¼¸å…¥
  if (arrowMap.hasOwnProperty(e.key)) {
    e.preventDefault(); // å…ˆé˜»æ­¢é è¨­è¡Œç‚º
    const symbol = arrowMap[e.key];
    input.value += symbol;

    const currentAnswer = input.value;
    const target = questions[currentIndex];

    // âœ… è‹¥ä¸æ˜¯æ­£ç¢ºé–‹é ­ï¼Œæ¸…ç©ºä¸¦è¨˜éŒ¯
    if (!target.startsWith(currentAnswer)) {
      wrongCount++;
      input.value = '';
    }
  }

  // âœ… ç©ºç™½éµæˆ– Enter åˆ¤æ–·ç­”æ¡ˆ
  if (e.key === ' ' || e.code === 'Space' || e.key === 'Enter') {
    e.preventDefault();
    checkAnswer();

  //input.value = ''; // â†âœ… å¼·åˆ¶æ¸…ç©ºä»»ä½•æ®˜ç•™ç©ºç™½
  }

});



    function generateQuestion(min, max) {
      const arrows = ['â†‘', 'â†“', 'â†', 'â†’'];
      const len = Math.floor(Math.random() * (max - min + 1)) + min;
      let str = '';
      for (let i = 0; i < len; i++) {
        str += arrows[Math.floor(Math.random() * arrows.length)];
      }
      return str;
    }

    function startGame() {
      const min = parseInt(document.getElementById('minLen').value);
      const max = parseInt(document.getElementById('maxLen').value);
      const count = parseInt(document.getElementById('count').value);

      if (min < 3 || max < 3 || count < 1 || max < min) {
        alert('è«‹ç¢ºèªè¼¸å…¥æ­£ç¢ºï¼ˆæœ€å°/æœ€å¤§ â‰¥ 3ï¼Œæœ€å¤§ä¸å¾—å°æ–¼æœ€å°ï¼Œé¡Œæ•¸ â‰¥ 1ï¼‰');
        return;
      }

      questions = Array.from({ length: count }, () => generateQuestion(min, max));
      totalQuestions = count;
      currentIndex = 0;
      wrongCount = 0;
      startTime = Date.now();
      input.value = '';
      input.focus();
      showQuestion();
      resultDiv.textContent = '';
    }

    function showQuestion() {
      questionDiv.textContent = questions[currentIndex] || '';
    }

    function checkAnswer() {
  if (!questions.length) return;
  const ans = input.value;
  const target = questions[currentIndex];
  if (ans === target) {
    currentIndex++;
    input.value = '';
    if (currentIndex >= questions.length) {
      endGame(true);
    } else {
      showQuestion();
    }
  } else {
    wrongCount++;
    input.value = '';
  }
}


    function endGame(success) {
      const duration = Math.floor((Date.now() - startTime) / 1000);
      const done = success ? totalQuestions : currentIndex;
      const msg = success
        ? `(å…± ${totalQuestions} é¡Œ) éŒ¯èª¤ ${wrongCount} æ¬¡ã€€èŠ±è²» ${duration} ç§’`
        : `æ”¾æ£„ï¼šå…± ${totalQuestions} é¡Œï¼Œå®Œæˆ ${done} é¡Œï¼ŒéŒ¯èª¤ ${wrongCount} æ¬¡ã€€èŠ±è²» ${duration} ç§’`;

      const div = document.createElement('div');
      div.textContent = msg;
      historyDiv.appendChild(div);

      questions = [];
      questionDiv.textContent = '';
      input.value = '';
    }

    function giveUp() {
      if (!questions.length) return;
      endGame(false);
    }

    function clearHistory() {
      historyDiv.innerHTML = '';
    }



    // æ‰‹æ©Ÿç”¨è™›æ“¬éµæ¨¡æ“¬æ–¹å‘éµ
function simulateKey(keyName) {
  const e = new KeyboardEvent('keydown', { key: keyName, code: keyName });
  document.dispatchEvent(e);
}





  </script>
</body>
</html>
